<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Me Games English - TÜBİTAK Final</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- TEMA DEĞİŞKENLERİ --- */
        :root {
            --primary: #0d9488;          
            --bg-body: #f8fafc;          
            --bg-card: #ffffff;          
            --text-main: #0f172a;        
            --text-sub: #64748b;         
            --border: #e2e8f0;           
            --t1-color: #ef4444;         
            --t1-bg: #fff5f5;            
            --t2-color: #3b82f6;         
            --t2-bg: #f0f7ff;            
            --success: #22c55e;
            --splash-bg: #ffffff;
        }

        body.dark-mode {
            --primary: #14b8a6;
            --bg-body: #020617;
            --bg-card: #0f172a;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --border: #1e293b;
            --t1-bg: rgba(239, 68, 68, 0.1);
            --t2-bg: rgba(59, 130, 246, 0.1);
            --splash-bg: #0f172a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; transition: background-color 0.3s, color 0.3s; }
        body { background-color: var(--bg-body); color: var(--text-main); min-height: 100vh; display: flex; flex-direction: column; overflow-x: hidden; }

        /* --- SPLASH SCREEN (LOGO GÖSTERİMİ) --- */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background-color: var(--splash-bg); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.8s ease-out, visibility 0.8s;
        }
        .splash-logo {
            max-width: 400px; width: 80%;
            animation: pulseLogo 3s infinite ease-in-out;
        }
        #splash-screen.hidden-splash { opacity: 0; visibility: hidden; }
        @keyframes pulseLogo { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.9; } }

        /* HEADER */
        header { 
            background: var(--bg-card); padding: 15px 40px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); border-bottom: 1px solid var(--border); 
            z-index: 50;
        }
        .logo { font-size: 26px; font-weight: 800; color: var(--primary); display: flex; align-items: center; gap: 12px; }

        .controls { display: flex; gap: 12px; align-items: center; }
        .control-btn {
            background: var(--bg-body); border: 1px solid var(--border);
            padding: 10px 18px; border-radius: 12px; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
            font-weight: 700; font-size: 14px; color: var(--text-main);
            user-select: none; transition: 0.2s;
        }
        .control-btn:hover { border-color: var(--primary); transform: translateY(-2px); }

        /* CONTAINER */
        .container { flex: 1; display: flex; flex-direction: column; width: 100%; position: relative; }
        .card { 
            background: var(--bg-card); border-radius: 24px; padding: 40px; 
            margin: 40px auto; max-width: 1000px; width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.04); border: 1px solid var(--border); text-align: center; 
        }

        /* HAKKINDA EKRANI STİLLERİ */
        .about-container { text-align: left; }
        .about-box { 
            background: var(--bg-body); padding: 25px; 
            border-radius: 16px; border: 1px solid var(--border); 
            margin-bottom: 20px; display: flex; gap: 20px; align-items: flex-start;
        }
        .about-box i { font-size: 28px; color: var(--primary); margin-top: 5px; flex-shrink: 0; }
        .about-content h3 { font-weight: 800; margin-bottom: 8px; color: var(--text-main); font-size: 18px; }
        .about-content p { color: var(--text-sub); line-height: 1.6; font-size: 15px; }

        /* TEAM SETUP */
        .team-setup-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .input-wrapper label { display: block; margin-bottom: 8px; font-weight: 800; }
        .input-wrapper input { 
            width: 100%; padding: 15px; border-radius: 12px; 
            border: 2px solid var(--border); background: var(--bg-body); color: var(--text-main);
            font-weight: 700; font-size: 16px;
        }

        /* SELECTION SCREEN (KURA) */
        #screenSelector {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: calc(100vh - 80px); width: 100%; background: var(--bg-body);
        }
        .selector-box { display: flex; gap: 50px; margin-bottom: 40px; justify-content: center; flex-wrap: wrap; }
        .player-card {
            background: var(--bg-card); border: 2px solid var(--border);
            border-radius: 30px; padding: 30px; width: 300px; text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1); position: relative;
        }
        .number-display { font-size: 80px; font-weight: 900; line-height: 1; margin: 20px 0; }
        .card-t1 h3, .card-t1 .number-display { color: var(--t1-color); }
        .card-t2 h3, .card-t2 .number-display { color: var(--t2-color); }

        .btn-ready-big {
            padding: 20px 50px; font-size: 22px; font-weight: 800;
            background: var(--primary); color: white; border: none; border-radius: 16px;
            cursor: pointer; box-shadow: 0 10px 25px rgba(13, 148, 136, 0.3); transition: 0.2s;
        }
        .btn-ready-big:disabled { background: var(--text-sub); cursor: not-allowed; opacity: 0.7; }

        /* GAME SCREEN */
        #screenGame { display: flex; flex-direction: row; height: calc(100vh - 80px); width: 100vw; position: relative; }
        .team-zone { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; position: relative; }
        .team-1-zone { background: var(--t1-bg); border-right: 2px dashed var(--border); }
        .team-2-zone { background: var(--t2-bg); }

        .team-header { position: absolute; top: 30px; text-align: center; width: 100%; }
        .score-display { font-size: 60px; font-weight: 900; line-height: 1; }
        .active-player-badge {
            background: var(--text-main); color: var(--bg-body);
            padding: 5px 15px; border-radius: 20px; font-weight: 800; font-size: 18px;
            display: inline-block; margin-top: 5px;
        }

        .central-word-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10;
            background: #0f172a; color: white; padding: 25px 50px; border-radius: 20px;
            font-size: 42px; font-weight: 800; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            text-transform: uppercase; border: 4px solid var(--bg-card); text-align: center;
            transition: 0.3s;
        }

        /* --- ALTIN SORU --- */
        .golden-question .central-word-container {
            background: linear-gradient(135deg, #b45309 0%, #f59e0b 50%, #fbbf24 100%);
            border-color: #fcd34d;
            box-shadow: 0 0 50px rgba(245, 158, 11, 0.6);
            animation: goldPulse 1.5s infinite;
        }
        @keyframes goldPulse { 0% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.05); } 100% { transform: translate(-50%, -50%) scale(1); } }
        
        .golden-tag {
            display: none; position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            background: #ef4444; color: white; padding: 5px 15px; border-radius: 20px; 
            font-size: 14px; font-weight: 800; white-space: nowrap; border: 2px solid white;
        }
        .golden-question .golden-tag { display: block; }

        .options-column { display: grid; grid-template-columns: 1fr; gap: 15px; width: 100%; max-width: 350px; margin-top: 80px; }
        .opt-btn {
            padding: 20px; background: var(--bg-card); border: 3px solid var(--border); color: var(--text-main);
            border-radius: 16px; font-size: 20px; font-weight: 700; cursor: pointer;
        }
        .team-1-zone .opt-btn:hover:not(:disabled) { border-color: var(--t1-color); }
        .team-2-zone .opt-btn:hover:not(:disabled) { border-color: var(--t2-color); }

        .opt-btn.correct { background: var(--success) !important; color: white !important; border-color: var(--success) !important; }
        .opt-btn.wrong { background: var(--t1-color) !important; color: white !important; border-color: var(--t1-color) !important; }

        .unit-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 30px; }
        .unit-btn { 
            background: var(--bg-card); border: 2px solid var(--border); color: var(--text-main);
            padding: 25px; border-radius: 20px; cursor: pointer; 
            font-weight: 700; display: flex; flex-direction: column; gap: 10px; align-items: center; 
        }

        .btn-main { padding: 18px 50px; background: var(--primary); color: white; border: none; border-radius: 14px; font-size: 18px; font-weight: 800; cursor: pointer; }
        .signature { font-family: 'Dancing Script', cursive; font-size: 24px; color: var(--primary); margin-top: 30px; display: block; opacity: 0.8; }
        .hidden { display: none !important; }
        .confetti { position: absolute; width: 10px; height: 10px; top: -10px; border-radius: 50%; animation: fall 3s linear forwards; z-index: 100; }
        @keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
    </style>
</head>
<body>

<div id="splash-screen">
    <img src="image.png" alt="Me Games English" class="splash-logo">
</div>

<header>
    <div class="logo"><i class="fas fa-graduation-cap"></i> Me Games English</div>
    <div class="controls">
        <div class="control-btn" onclick="goHome()" title="Ana Menü"><i class="fas fa-home"></i></div>
        <div class="control-btn" onclick="showAbout()" title="Proje Hakkında"><i class="fas fa-info-circle"></i></div>
        <div class="control-btn" onclick="toggleFullScreen()" title="Tam Ekran"><i class="fas fa-expand" id="iconFull"></i></div>
        <div class="control-btn" onclick="toggleTheme()" id="btnTheme"><i class="fas fa-moon"></i> <span>Dark</span></div>
        <div class="control-btn" onclick="toggleLang()" id="btnLang"><i class="fas fa-globe"></i> <span>TR</span></div>
    </div>
</header>

<div class="container">
    <div id="screenTeams" class="card">
        <h1 id="txtWelcome">Hoş Geldiniz</h1>
        <p style="color:var(--text-sub); margin-bottom:30px" id="txtDesc">Sınıf mevcutlarını girin</p>
        <div class="team-setup-grid">
            <div style="text-align:left;">
                <div class="input-wrapper" style="margin-bottom:15px;">
                    <label style="color:var(--t1-color)" id="lblT1">1. Takım Adı</label>
                    <input type="text" id="t1Input" value="KARTALLAR">
                </div>
                <div class="input-wrapper">
                    <label id="lblT1Size"><i class="fas fa-users"></i> Mevcut</label>
                    <input type="number" id="t1SizeInput" value="15" min="1">
                </div>
            </div>
            <div style="text-align:left;">
                <div class="input-wrapper" style="margin-bottom:15px;">
                    <label style="color:var(--t2-color)" id="lblT2">2. Takım Adı</label>
                    <input type="text" id="t2Input" value="ASLANLAR">
                </div>
                <div class="input-wrapper">
                    <label id="lblT2Size"><i class="fas fa-users"></i> Mevcut</label>
                    <input type="number" id="t2SizeInput" value="15" min="1">
                </div>
            </div>
        </div>
        <button class="btn-main" onclick="goToUnits()" id="btnGoUnits">Devam Et</button>
        <span class="signature">Designed by Muhammed Emir Turhan</span>
    </div>

    <div id="screenAbout" class="card hidden">
        <h1 style="margin-bottom: 30px;"><i class="fas fa-project-diagram"></i> Proje Hakkında & Teknik Detaylar</h1>
        <div class="about-container">
            
            <div class="about-box">
                <i class="fas fa-bullseye"></i>
                <div class="about-content">
                    <h3>1. MEB & LGS Odaklı Müfredat Entegrasyonu</h3>
                    <p>İnternetteki genel oyunların aksine, bu proje tamamen <strong>MEB 8. Sınıf Müfredatı ve LGS kelimelerine</strong> göre optimize edilmiştir. Öğrenciler rastgele değil, doğrudan sınavda çıkacak 'Hedefe Yönelik' kelimelerle çalışır.</p>
                </div>
            </div>

            <div class="about-box">
                <i class="fas fa-random"></i>
                <div class="about-content">
                    <h3>2. 'Rastgele Seçim Algoritması' (Adil Katılım)</h3>
                    <p>Sınıfta arka sıralarda kalan öğrencileri dahil etmek için özel bir <strong>Slot Makinesi Algoritması</strong> geliştirdik. Bu sistem, tahtaya kalkacak öğrenciyi tamamen matematiksel bir rastgelelikle seçerek <strong>fırsat eşitliği</strong> sağlar.</p>
                </div>
            </div>

            <div class="about-box">
                <i class="fas fa-chalkboard-teacher"></i>
                <div class="about-content">
                    <h3>3. Akıllı Tahta & Fiziksel Etkileşim</h3>
                    <p>Telefon gerektiren bireysel uygulamaların aksine, bu sistem <strong>Akıllı Tahta (Smart Board)</strong> odaklıdır. İki öğrenciyi fiziksel olarak tahtaya kaldırıp yan yana rekabet ettirerek <strong>sosyal öğrenmeyi</strong> tetikler.</p>
                </div>
            </div>

            <div class="about-box">
                <i class="fas fa-gamepad"></i>
                <div class="about-content">
                    <h3>4. Oyunlaştırma (Gamification) & Altın Soru</h3>
                    <p>Eğitimi eğlenceyle birleştirmek için <strong>'Altın Soru' (Golden Question)</strong> mekaniği eklenmiştir. Rastgele gelen yüksek puanlı sorular, rekabetin ve heyecanın son ana kadar canlı kalmasını sağlar.</p>
                </div>
            </div>

            <div class="about-box">
                <i class="fas fa-user-tie"></i>
                <div class="about-content">
                    <h3>5. Öğretmen Kontrol Paneli</h3>
                    <p>Oyun akışı otomatiğe bağlanmamıştır. <strong>'Manuel Geçiş Sistemi'</strong> sayesinde kontrol tamamen öğretmendedir. Öğretmen istediği an araya girip kelimeyi açıklayabilir; bu bir oyuncak değil, bir <strong>ders materyalidir</strong>.</p>
                </div>
            </div>

        </div>
        <button class="btn-main" onclick="goHome()" style="margin-top: 20px;">Ana Menüye Dön</button>
    </div>

    <div id="screenUnits" class="card hidden">
        <h1 id="txtSelectUnit">Ünite Seçin</h1>
        <div class="unit-grid" id="unitGrid"></div>
    </div>

    <div id="screenSelector" class="hidden">
        <h1 style="margin-bottom: 40px;" id="txtWhoNext">Sıradaki Oyuncular</h1>
        <div class="selector-box">
            <div class="player-card card-t1">
                <h3 id="selT1Name">TAKIM 1</h3>
                <div class="number-display" id="animNum1">?</div>
                <i class="fas fa-user-astronaut" style="font-size: 30px; opacity: 0.2;"></i>
            </div>
            <div class="player-card card-t2">
                <h3 id="selT2Name">TAKIM 2</h3>
                <div class="number-display" id="animNum2">?</div>
                <i class="fas fa-user-astronaut" style="font-size: 30px; opacity: 0.2;"></i>
            </div>
        </div>
        <button class="btn-ready-big" id="btnReveal" onclick="startActualGame()" disabled>
            <i class="fas fa-spinner fa-spin"></i> <span id="btnRevealText">Kura Çekiliyor...</span>
        </button>
    </div>

    <div id="screenGame" class="hidden">
        <div class="central-word-container" id="wordDisplay">
            <div class="golden-tag">✨ ALTIN SORU ✨</div>
            <span id="wordText">WORD</span>
        </div>
        
        <div class="team-zone team-1-zone">
            <div class="team-header">
                <div class="team-name-tag" id="dispT1Name">TAKIM 1</div>
                <div class="score-display" id="score1">0</div>
                <div class="active-player-badge" id="badge1">Oyuncu #?</div>
            </div>
            <div class="options-column" id="opts1"></div>
        </div>
        <div class="team-zone team-2-zone">
            <div class="team-header">
                <div class="team-name-tag" id="dispT2Name">TAKIM 2</div>
                <div class="score-display" id="score2">0</div>
                <div class="active-player-badge" id="badge2">Oyuncu #?</div>
            </div>
            <div class="options-column" id="opts2"></div>
        </div>
    </div>

    <div id="screenResult" class="card hidden">
        <h1 id="txtGameOver">OYUN BİTTİ</h1>
        <h2 id="winnerName" style="font-size: 56px; margin: 30px 0; color: var(--primary);"></h2>
        <button class="btn-main" onclick="goHome()" id="btnRestart">YENİDEN BAŞLAT</button>
    </div>
</div>

<script>
    // --- MEB 8. SINIF KELİME HAVUZU (10 ÜNİTE) ---
    const units = [
        { id: 1, name: "Friendship", icon: "fa-handshake", words: [{e:"Back up", t:"Desteklemek"}, {e:"Count on", t:"Güvenmek"}, {e:"Get on well", t:"İyi geçinmek"}, {e:"Laid-back", t:"Rahat/Gamsız"}, {e:"Slumber party", t:"Pijama partisi"}, {e:"Stubborn", t:"İnatçı"}, {e:"Tactful", t:"Anlayışlı/Nazik"}, {e:"Buddy", t:"Kanka"}, {e:"Secret", t:"Sır"}, {e:"Trust", t:"Güvenmek"}] },
        { id: 2, name: "Teen Life", icon: "fa-headphones", words: [{e:"Unbearable", t:"Dayanılmaz"}, {e:"Terrific", t:"Müthiş"}, {e:"Ridiculous", t:"Gülünç"}, {e:"Snob", t:"Burnu havada"}, {e:"Harmonic", t:"Uyumlu"}, {e:"Casual", t:"Günlük (Giyim)"}, {e:"Trendy", t:"Modaya uygun"}, {e:"Pitch a tent", t:"Çadır kurmak"}, {e:"Campfire", t:"Kamp ateşi"}] },
        { id: 3, name: "In The Kitchen", icon: "fa-utensils", words: [{e:"Dough", t:"Hamur"}, {e:"Knead", t:"Yoğurmak"}, {e:"Sprinkle", t:"Serpmek"}, {e:"Marinate", t:"Terbiye etmek"}, {e:"Season", t:"Baharatlamak"}, {e:"Peel", t:"Soymak"}, {e:"Dice", t:"Küp küp doğramak"}, {e:"Grater", t:"Rende"}, {e:"Whisk", t:"Çırpmak"}] },
        { id: 4, name: "On The Phone", icon: "fa-phone", words: [{e:"Put through", t:"Telefonu bağlamak"}, {e:"Bad line", t:"Hat kötü"}, {e:"Hang on", t:"Beklemek"}, {e:"Memo", t:"Kısa not"}, {e:"Available", t:"Müsait"}, {e:"Engaged", t:"Meşgul"}, {e:"Keep in touch", t:"İletişimde kalmak"}, {e:"Dial", t:"Tuşlamak"}, {e:"Extension", t:"Dahili hat"}] },
        { id: 5, name: "The Internet", icon: "fa-wifi", words: [{e:"Connection", t:"Bağlantı"}, {e:"Broken", t:"Bozuk"}, {e:"Register", t:"Kaydolmak"}, {e:"Notification", t:"Bildirim"}, {e:"Search engine", t:"Arama motoru"}, {e:"Attachment", t:"Dosya eki"}, {e:"Access", t:"Erişim"}, {e:"Confirm", t:"Onaylamak"}, {e:"Account", t:"Hesap"}] },
        { id: 6, name: "Adventures", icon: "fa-mountain", words: [{e:"Eye-catching", t:"Göz alıcı"}, {e:"Fascinating", t:"Büyüleyici"}, {e:"Risk", t:"Risk"}, {e:"Helmet", t:"Kask"}, {e:"Paddles", t:"Kürekler"}, {e:"Ambitious", t:"Hırslı"}, {e:"Challenging", t:"Zorlayıcı"}, {e:"Entertaining", t:"Eğlenceli"}, {e:"Cave diving", t:"Mağara dalışı"}] },
        { id: 7, name: "Tourism", icon: "fa-plane", words: [{e:"Architecture", t:"Mimari"}, {e:"Bed and breakfast", t:"Yatak ve kahvaltı"}, {e:"All-inclusive", t:"Her şey dahil"}, {e:"Ancient", t:"Antik"}, {e:"Destination", t:"Varış yeri"}, {e:"Sightseeing", t:"Gezi"}, {e:"Souvenir", t:"Hediyelik eşya"}, {e:"Accommodation", t:"Konaklama"}, {e:"Climate", t:"İklim"}] },
        { id: 8, name: "Chores", icon: "fa-broom", words: [{e:"Do the laundry", t:"Çamaşır yıkamak"}, {e:"Load dishwasher", t:"Makineyi doldurmak"}, {e:"Dust shelves", t:"Toz almak"}, {e:"Mopping", t:"Paspas yapmak"}, {e:"Ironing", t:"Ütü yapmak"}, {e:"Responsibility", t:"Sorumluluk"}, {e:"Set the table", t:"Masayı kurmak"}, {e:"Take out trash", t:"Çöpü çıkarmak"}, {e:"Tidy up", t:"Toparlamak"}] },
        { id: 9, name: "Science", icon: "fa-flask", words: [{e:"Test tube", t:"Deney tüpü"}, {e:"Vaccination", t:"Aşılama"}, {e:"Fossil", t:"Fosil"}, {e:"Solar system", t:"Güneş sistemi"}, {e:"Explosion", t:"Patlama"}, {e:"High-tech", t:"Yüksek teknoloji"}, {e:"Genius", t:"Dahi"}, {e:"Lab", t:"Laboratuvar"}, {e:"Process", t:"Süreç"}] },
        { id: 10, name: "Natural Forces", icon: "fa-bolt", words: [{e:"Avalanche", t:"Çığ"}, {e:"Hurricane", t:"Kasırga"}, {e:"Shortage", t:"Kıtlık"}, {e:"Waste", t:"İsraf etmek"}, {e:"Eco-friendly", t:"Çevre dostu"}, {e:"Global warming", t:"Küresel ısınma"}, {e:"Magnitude", t:"Büyüklük"}, {e:"Prediction", t:"Tahmin"}, {e:"Take precaution", t:"Önlem almak"}] }
    ];

    let currentLang = 'tr';
    let selectedUnit = null;
    let scores = [0, 0];
    let wordPool = [];
    let currentWord = null;
    let isRoundActive = false;
    let isGoldenQuestion = false;
    let t1Size = 15;
    let t2Size = 15;
    let currentP1 = 0;
    let currentP2 = 0;

    const ui = {
        tr: { welcome: "Hoş Geldiniz", desc: "Sınıf mevcutlarını girin", lblT1: "1. Takım Adı", lblT2: "2. Takım Adı", lblSize: "Mevcut", go: "Devam Et", select: "Ünite Seçin", end: "OYUN BİTTİ", restart: "YENİDEN BAŞLAT", win: "KAZANAN: ", draw: "BERABERE", dark: "Koyu", light: "Açık", rolling: "Kura Çekiliyor...", show: "SORUYU GÖSTER", who: "Sıradaki Oyuncular" },
        en: { welcome: "Welcome", desc: "Enter class sizes", lblT1: "1st Team Name", lblT2: "2nd Team Name", lblSize: "Size", go: "Continue", select: "Select Unit", end: "GAME OVER", restart: "RESTART", win: "WINNER: ", draw: "DRAW", dark: "Dark", light: "Light", rolling: "Selecting...", show: "SHOW QUESTION", who: "Next Players" }
    };

    window.addEventListener('load', () => {
        setTimeout(() => { document.getElementById('splash-screen').classList.add('hidden-splash'); }, 2000);
    });

    function toggleFullScreen() {
        if (!document.fullscreenElement) { document.documentElement.requestFullscreen(); document.getElementById('iconFull').classList.remove('fa-expand'); document.getElementById('iconFull').classList.add('fa-compress'); } 
        else { if (document.exitFullscreen) { document.exitFullscreen(); document.getElementById('iconFull').classList.remove('fa-compress'); document.getElementById('iconFull').classList.add('fa-expand'); } }
    }

    function goHome() {
        document.querySelectorAll('.hidden').forEach(el => el.classList.add('hidden'));
        document.getElementById('screenTeams').classList.remove('hidden');
        document.getElementById('screenUnits').classList.add('hidden');
        document.getElementById('screenSelector').classList.add('hidden');
        document.getElementById('screenGame').classList.add('hidden');
        document.getElementById('screenResult').classList.add('hidden');
        document.getElementById('screenAbout').classList.add('hidden');
        scores = [0, 0]; updateScores();
    }

    function showAbout() {
        document.querySelectorAll('.hidden').forEach(el => el.classList.add('hidden'));
        document.getElementById('screenTeams').classList.add('hidden');
        document.getElementById('screenAbout').classList.remove('hidden');
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
        const isDark = document.body.classList.contains('dark-mode');
        const btn = document.getElementById('btnTheme');
        btn.querySelector('i').className = isDark ? "fas fa-sun" : "fas fa-moon";
        btn.querySelector('span').textContent = isDark ? ui[currentLang].light : ui[currentLang].dark;
    }

    function toggleLang() {
        currentLang = currentLang === 'tr' ? 'en' : 'tr';
        document.getElementById('btnLang').querySelector('span').textContent = currentLang.toUpperCase();
        updateMenuLang();
    }

    function updateMenuLang() {
        const t = ui[currentLang];
        document.getElementById('txtWelcome').textContent = t.welcome;
        document.getElementById('txtDesc').textContent = t.desc;
        document.getElementById('lblT1').textContent = t.lblT1;
        document.getElementById('lblT2').textContent = t.lblT2;
        document.getElementById('lblT1Size').innerHTML = `<i class="fas fa-users"></i> ${t.lblSize}`;
        document.getElementById('lblT2Size').innerHTML = `<i class="fas fa-users"></i> ${t.lblSize}`;
        document.getElementById('btnGoUnits').textContent = t.go;
        document.getElementById('txtSelectUnit').textContent = t.select;
        document.getElementById('txtGameOver').textContent = t.end;
        document.getElementById('btnRestart').textContent = t.restart;
        document.getElementById('txtWhoNext').textContent = t.who;
    }

    function goToUnits() {
        t1Size = parseInt(document.getElementById('t1SizeInput').value) || 15;
        t2Size = parseInt(document.getElementById('t2SizeInput').value) || 15;
        document.getElementById('screenTeams').classList.add('hidden');
        document.getElementById('screenUnits').classList.remove('hidden');
        const grid = document.getElementById('unitGrid');
        grid.innerHTML = '';
        units.forEach(u => {
            const btn = document.createElement('button');
            btn.className = 'unit-btn';
            btn.innerHTML = `<i class="fas ${u.icon}"></i><span>${u.name}</span>`;
            btn.onclick = () => startCompetition(u);
            grid.appendChild(btn);
        });
    }

    function startCompetition(unit) {
        selectedUnit = unit;
        wordPool = [...unit.words].sort(() => Math.random() - 0.5);
        document.getElementById('screenUnits').classList.add('hidden');
        document.getElementById('dispT1Name').textContent = document.getElementById('t1Input').value;
        document.getElementById('dispT2Name').textContent = document.getElementById('t2Input').value;
        document.getElementById('selT1Name').textContent = document.getElementById('t1Input').value;
        document.getElementById('selT2Name').textContent = document.getElementById('t2Input').value;
        goToSelector();
    }

    function goToSelector() {
        if (wordPool.length === 0) { endGame(); return; }
        document.getElementById('screenGame').classList.add('hidden');
        document.getElementById('screenSelector').classList.remove('hidden');
        const btn = document.getElementById('btnReveal');
        btn.disabled = true;
        btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${ui[currentLang].rolling}`;
        btn.style.background = "#94a3b8";
        let counter = 0;
        const interval = setInterval(() => {
            document.getElementById('animNum1').textContent = Math.floor(Math.random() * t1Size) + 1;
            document.getElementById('animNum2').textContent = Math.floor(Math.random() * t2Size) + 1;
            counter++;
            if(counter > 20) {
                clearInterval(interval);
                finalizeSelection();
            }
        }, 100);
    }

    function finalizeSelection() {
        currentP1 = Math.floor(Math.random() * t1Size) + 1;
        currentP2 = Math.floor(Math.random() * t2Size) + 1;
        document.getElementById('animNum1').textContent = currentP1;
        document.getElementById('animNum2').textContent = currentP2;
        const btn = document.getElementById('btnReveal');
        btn.disabled = false;
        btn.innerHTML = `<i class="fas fa-play"></i> ${ui[currentLang].show}`;
        btn.style.background = "var(--primary)";
    }

    function startActualGame() {
        document.getElementById('screenSelector').classList.add('hidden');
        document.getElementById('screenGame').classList.remove('hidden');
        document.getElementById('badge1').textContent = `Oyuncu #${currentP1}`;
        document.getElementById('badge2').textContent = `Oyuncu #${currentP2}`;
        
        isRoundActive = true;
        currentWord = wordPool.pop();
        
        // --- ALTIN SORU KONTROLÜ (%10 İhtimal) ---
        isGoldenQuestion = Math.random() < 0.1; 
        const gameContainer = document.getElementById('screenGame');
        if(isGoldenQuestion) {
            gameContainer.classList.add('golden-question');
        } else {
            gameContainer.classList.remove('golden-question');
        }

        document.getElementById('wordText').textContent = currentWord.e;
        
        let opts = [currentWord.t];
        let others = selectedUnit.words.filter(w => w.t !== currentWord.t).sort(() => Math.random() - 0.5);
        others.forEach(o => { if(opts.length < 4) opts.push(o.t); });
        while(opts.length < 4) { opts.push("..."); }
        opts.sort(() => Math.random() - 0.5);
        renderOptions(opts);
    }

    function renderOptions(opts) {
        const cont1 = document.getElementById('opts1');
        const cont2 = document.getElementById('opts2');
        cont1.innerHTML = ''; cont2.innerHTML = '';
        opts.forEach(o => {
            const b1 = document.createElement('button');
            b1.className = 'opt-btn'; b1.textContent = o;
            b1.onclick = () => check(1, b1, o);
            cont1.appendChild(b1);
            const b2 = document.createElement('button');
            b2.className = 'opt-btn'; b2.textContent = o;
            b2.onclick = () => check(2, b2, o);
            cont2.appendChild(b2);
        });
    }

    function check(teamId, btn, val) {
        if (!isRoundActive) return;
        if (val === currentWord.t) {
            isRoundActive = false;
            btn.classList.add('correct');
            // ALTIN SORU İSE +30, DEĞİLSE +10
            scores[teamId - 1] += isGoldenQuestion ? 30 : 10;
            updateScores();
            setTimeout(goToSelector, 2000);
        } else {
            scores[teamId - 1] -= 5;
            btn.classList.add('wrong');
            btn.disabled = true;
            updateScores();
        }
    }

    function updateScores() {
        document.getElementById('score1').textContent = scores[0];
        document.getElementById('score2').textContent = scores[1];
    }

    function endGame() {
        document.querySelectorAll('.hidden').forEach(el => el.classList.add('hidden'));
        document.getElementById('screenSelector').classList.add('hidden');
        document.getElementById('screenResult').classList.remove('hidden');
        const t1 = document.getElementById('t1Input').value;
        const t2 = document.getElementById('t2Input').value;
        const t = ui[currentLang];
        let winnerText = "";
        if (scores[0] > scores[1]) winnerText = t.win + t1;
        else if (scores[1] > scores[0]) winnerText = t.win + t2;
        else winnerText = t.draw;
        document.getElementById('winnerName').textContent = winnerText;
        startConfetti();
    }

    function startConfetti() {
        const colors = ["#ef4444", "#3b82f6", "#0d9488", "#f59e0b"];
        for(let i=0; i<60; i++) {
            const c = document.createElement('div');
            c.className = 'confetti';
            c.style.left = Math.random() * 100 + "vw";
            c.style.background = colors[Math.floor(Math.random()*colors.length)];
            c.style.animationDelay = Math.random() * 2 + "s";
            document.body.appendChild(c);
        }
    }
</script>

</body>
</html>